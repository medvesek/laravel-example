services:
    app:
        image: ghcr.io/medvesek/laravel-example:latest
        env_file: .env
        deploy:
            replicas: 1
            update_config:
                order: start-first
                parallelism: 1
                delay: 15s

    postgres:
        image: postgres:17
        volumes:
            - postgresdata:/var/lib/postgresql/data
        environment:
            POSTGRES_PASSWORD: ${DB_PASSWORD}
            POSTGRES_USER: ${DB_USERNAME}
            POSTGRES_DB: ${DB_DATABASE}

networks:
    traefik-net:
        external: true

volumes:
    postgresdata:
